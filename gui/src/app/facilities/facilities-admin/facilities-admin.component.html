<div class="container-fluid pt-5">
  <div class="card shadow-sm">
    <div class="card-body p-3 p-lg-5">
      <h4 class="card-title">
        {{'MENU.ALL_FACILITIES' | translate}}
      </h4>
      <mat-form-field class="w-100">
        <mat-icon matPrefix class="mr-1">search</mat-icon>
        <input matInput type="text" (keyup)="doFilter($event.target.value)" placeholder="{{ 'SEARCH' | translate}}">
      </mat-form-field>
      <div>
        <div *ngIf="isLoadingTable1" style="display: flex; justify-content: center; align-items: center; background: white;">
          <mat-progress-spinner color="primary" mode="indeterminate"></mat-progress-spinner>
        </div>
        <table *ngIf="!isLoadingTable1" mat-table  matSort #sort1="matSort" matSortActive="facilityId" matSortDirection="desc"
               matSortDisableClear [dataSource]="servicesDataSource" class="w-100">
          <ng-container matColumnDef="facilityId">
            <th mat-header-cell *matHeaderCellDef class="w-10" mat-sort-header>{{'COMMON.ID' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.facilityId}}</td>
          </ng-container>
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef class="w-20" mat-sort-header>{{'FACILITIES.NAME' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.name | itemLocale}}</td>
          </ng-container>
          <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef class="w-25" mat-sort-header>{{'FACILITIES.DESCRIPTION' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.description | itemLocale}}</td>
          </ng-container>
          <ng-container matColumnDef="identifier">
            <th mat-header-cell *matHeaderCellDef class="w-25" mat-sort-header>{{'FACILITIES.IDENTIFIER' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.identifier}}</td>
          </ng-container>
          <ng-container matColumnDef="environment">
            <th mat-header-cell *matHeaderCellDef class="w-10" mat-sort-header>{{'FACILITIES.ENVIRONMENT' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.environment | facilityEnvironment}}</td>
          </ng-container>
          <ng-container matColumnDef="protocol">
            <th mat-header-cell *matHeaderCellDef class="w-10" mat-sort-header>{{'FACILITIES.PROTOCOL' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.protocol }}</td>
          </ng-container>
          <ng-container matColumnDef="deleted">
            <th mat-header-cell *matHeaderCellDef class="w-3"></th>
            <td mat-cell *matCellDef="let providedService">
              <mat-icon *ngIf="providedService.facilityDeleted" color="warn">delete</mat-icon>
            </td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" [routerLink]="['/auth/facilities/detail', row.facilityId]"
              class="hover-dark clickable">
          </tr>
        </table>
        <mat-paginator #paginator1 [pageSizeOptions]="[10, 25, 50]" showFirstLastButtons></mat-paginator>
      </div>

      <div *ngIf="externalServicesEnabled">
        <h5>{{ 'FACILITIES.EXTERNAL' | translate}}</h5>
        <div *ngIf="isLoadingTable2" style="display: flex; justify-content: center; align-items: center; background: white;">
          <mat-progress-spinner color="primary" mode="indeterminate"></mat-progress-spinner>
        </div>
        <table *ngIf="!isLoadingTable2" mat-table matSort #sort2="matSort" matSortActive="facilityId" matSortDirection="desc"
               matSortDisableClear [dataSource]="externalServicesDataSource" class="w-100">
          <ng-container matColumnDef="facilityId">
            <th mat-header-cell *matHeaderCellDef class="w-10" mat-sort-header>{{'COMMON.ID' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.facilityId}}</td>
          </ng-container>
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef class="w-20" mat-sort-header>{{'FACILITIES.NAME' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.name | itemLocale}}</td>
          </ng-container>
          <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef class="w-25" mat-sort-header>{{'FACILITIES.DESCRIPTION' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.description | itemLocale}}</td>
          </ng-container>
          <ng-container matColumnDef="identifier">
            <th mat-header-cell *matHeaderCellDef class="w-25" mat-sort-header>{{'FACILITIES.IDENTIFIER' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.identifier}}</td>
          </ng-container>
          <ng-container matColumnDef="environment">
            <th mat-header-cell *matHeaderCellDef class="w-10" mat-sort-header>{{'FACILITIES.ENVIRONMENT' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.environment | facilityEnvironment}}</td>
          </ng-container>
          <ng-container matColumnDef="protocol">
            <th mat-header-cell *matHeaderCellDef class="w-10" mat-sort-header>{{'FACILITIES.PROTOCOL' | translate}}</th>
            <td mat-cell *matCellDef="let providedService">{{providedService.protocol }}</td>
          </ng-container>
          <tr mat-header-row *matHeaderRowDef="displayedColumnsExtServices; sticky: true"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumnsExtServices;" class="hover-dark">
          </tr>
        </table>
        <mat-paginator #paginator2 [pageSizeOptions]="[10, 25, 50]" showFirstLastButtons></mat-paginator>
      </div>
    </div>
  </div>
</div>
